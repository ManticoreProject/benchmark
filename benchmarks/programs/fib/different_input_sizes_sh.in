#!/bin/bash

PATH_TO_SWP=$1
PATH_TO_TRUNK=$2
NAME=$3
DESCRIPTION=$4

# number of times to test each data point; for statistical validity
NUM_TRIALS="@NUM_TRIALS@"
MANTI_BENCH_ROOT=@MANTI_BENCH_ROOT@
PMLCFLAGS="@PMLCFLAGS@"

$PATH_TO_SWP/bin/pmlc $PMLCFLAGS -o pfib-swp  pfib.mlb
$PATH_TO_TRUNK/bin/pmlc $PMLCFLAGS -o pfib-trunk pfib.mlb

for i in 10 20 30 32 34 36 37 38 39; do
    $MANTI_BENCH_ROOT/scripts/experiment.sh -p @NUM_PROCS@ -f pfib-swp -n "$NAME" -d "$DESCRIPTION" -t $NUM_TRIALS -r $PATH_TO_SWP -s $i
    $MANTI_BENCH_ROOT/scripts/experiment.sh -p @NUM_PROCS@ -f pfib-trunk -n "$NAME" -d "$DESCRIPTION" -t $NUM_TRIALS -r $PATH_TO_TRUNK -s $i
done