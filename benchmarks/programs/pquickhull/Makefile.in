# Makefile for pquickhull benchmarks
#
# @configure_input@
#

SHELL =		/bin/sh

SMLNJ =		@SMLNJ_CMD@
MLTON =		@MLTON@
PMLC =		@PMLC@
PMLCFLAGS=@PMLCFLAGS@

TARGET =	pquickhull

all:		$(TARGET)-par $(TARGET)-seq-elison quickhull-smlnj gen-points quickhull-mlton

$(TARGET)-par:	pquickhull.mlb pquickhull.pml
	$(PMLC) $(PMLCFLAGS) -o $(TARGET)-par pquickhull.mlb

$(TARGET)-seq-elison:	pquickhull.mlb pquickhull.pml
	$(PMLC) $(PMLCFLAGS) -Csequential=true -o $(TARGET)-seq-elison pquickhull.mlb

quickhull-smlnj:	quickhull.cm quickhull.sml
	echo "SMLofNJ.exportFn(\"quickhull-smlnj\", Main.main);" | $(SMLNJ) quickhull.cm

quickhull-mlton:	quickhull-mlton.mlb quickhull.sml
	$(MLTON) -output quickhull-mlton quickhull-mlton.mlb

gen-points:	gen-points.sml gen-points.cm
	echo "SMLofNJ.exportFn(\"gen-points\", Main.main);" | $(SMLNJ) gen-points.cm
	sml @SMLload=gen-points 1000000 file > points.txt

.PHONY: clean
clean:
	rm -f $(TARGET)-par $(TARGET)-seq-elison *.s quickhull-mlton
